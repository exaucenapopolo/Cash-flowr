<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>MULAFLOWR - Challenge and Rewards</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700;800&family=Poppins:wght@400;500;600&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Pacifico&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;500&display=swap" rel="stylesheet"> 
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
  
  <style>
    /* Styles de base */
    body {
      background: linear-gradient(135deg, #d5e8d9 0%, #c5dfe6 100%);
      color: var(--text-color);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      visibility: hidden; 
      opacity: 0;
      transition: opacity 0.5s ease, visibility 0.5s ease;
    }

    body.loaded {
      visibility: visible;
      opacity: 1;
    }

    :root {
      --primary-color: #3a8ee6;
      --primary-light: #4da6ff;
      --primary-dark: #2c75c9;
      --secondary-color: #4c566a;
      --accent-color: #5e81ac;
      --background-light: #f5f7fb;
      --background-dark: #e5e9f0;
      --card-bg: #ffffff;
      --text-color: #2e3440;
      --text-light: #4c566a;
      --success-color: #4CD964;
      --warning-color: #FF9500;
      --danger-color: #FF3B30;
      --purple-color: #AF52DE;
      --teal-color: #5AC8FA;
      --orange-color: #FF9500;
      --pink-color: #FF2D55;
      --shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
      --transition: all 0.3s ease;
      --badge-active: #4CD964;
      --badge-pending: #FF9500;
      --badge-inactive: #FF3B30;
      --gold-color: #FFD700;
      --silver-color: #C0C0C0;
      --bronze-color: #CD7F32;
    }

    .dark-mode {
      --primary-color: #5e81ac;
      --primary-light: #81a1c1;
      --primary-dark: #4c566a;
      --secondary-color: #d8dee9;
      --accent-color: #88c0d0;
      --background-light: #2e3440;
      --background-dark: #3b4252;
      --card-bg: #434c5e;
      --text-color: #eceff4;
      --text-light: #d8dee9;
      --success-color: #4CD964;
      --warning-color: #FF9500;
      --danger-color: #FF3B30;
      --purple-color: #AF52DE;
      --teal-color: #5AC8FA;
      --orange-color: #FF9500;
      --pink-color: #FF2D55;
      --shadow: 0 4px 12px rgba(0, 0, 0, 0.25);
      --badge-active: #2ecc71;
      --badge-pending: #f1c40f;
      --badge-inactive: #e74c3c;
      --gold-color: #FFD700;
      --silver-color: #C0C0C0;
      --bronze-color: #CD7F32;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Poppins', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      transition: var(--transition);
    }
    
    /* Loader */
    .loader-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #d5e8d9 0%, #c5dfe6 100%);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 9999;
      transition: opacity 0.5s ease, visibility 0.5s ease;
    }

    .loader-container.hidden {
      opacity: 0;
      visibility: hidden;
    }

    .loader {
      width: 60px;
      height: 60px;
      border-radius: 50%;
      background: conic-gradient(#0000 10%, var(--primary-color));
      -webkit-mask: radial-gradient(farthest-side, #0000 calc(100% - 8px), #000 0);
      animation: spin 1s infinite linear;
    }

    @keyframes spin {
      to {
        transform: rotate(1turn);
      }
    }

    /* Header styles */
    .header {
      background-color: var(--card-bg);
      box-shadow: var(--shadow);
      padding: 15px 30px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      position: sticky;
      top: 0;
      z-index: 100;
    }

    .logo {
      font-size: 1.8rem;
      font-weight: 800;
      color: var(--primary-color);
      display: flex;
      align-items: center;
      font-family: 'Montserrat', sans-serif;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .header-controls {
      display: flex;
      align-items: center;
      gap: 15px;
    }

    .language-selector {
      background-color: var(--primary-light);
      color: white;
      border: none;
      border-radius: 20px;
      padding: 8px 15px;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 8px;
      font-weight: 500;
    }

    .theme-toggle {
        background-color: transparent;
        border: none;
        color: var(--secondary-color);
        cursor: pointer;
        padding: 5px;
        border-radius: 50%;
        width: 40px;
        height: 40px;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: background-color 0.3s ease;
    }

    .theme-toggle:hover {
        background-color: rgba(0, 0, 0, 0.05);
    }
    .theme-toggle i {
        font-size: 1.2rem;
    }

    .user-profile {
      display: flex;
      align-items: center;
      gap: 10px;
      cursor: pointer;
      position: relative;
    }
    
    .user-profile .avatar {
      width: 45px;
      height: 45px;
      border-radius: 50%;
      background-color: var(--primary-color);
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 1.2rem;
      font-weight: bold;
      border: 2px solid var(--primary-light);
      box-shadow: var(--shadow);
    }

    .profile-dropdown {
        position: absolute;
        top: 100%;
        right: 0;
        background-color: var(--card-bg);
        box-shadow: var(--shadow);
        border-radius: 8px;
        padding: 10px;
        display: none;
        flex-direction: column;
        gap: 5px;
        min-width: 150px;
        z-index: 200;
        transform-origin: top right;
        animation: scaleIn 0.2s ease-out forwards;
    }

    .profile-dropdown.active {
        display: flex;
    }
    
    @keyframes scaleIn {
        from { transform: scale(0.9); opacity: 0; }
        to { transform: scale(1); opacity: 1; }
    }

    .profile-dropdown .theme-toggle {
        width: 100%;
        border-radius: 8px;
        background-color: rgba(0, 0, 0, 0.05);
        color: var(--text-color);
        justify-content: flex-start;
        padding: 10px;
        transition: background-color 0.2s ease, transform 0.2s ease;
        text-align: left;
        gap: 10px;
    }
    .profile-dropdown .theme-toggle:hover {
        background-color: rgba(0, 0, 0, 0.1);
        transform: translateY(-2px);
    }
    
    .profile-dropdown .theme-toggle span {
        flex-grow: 1;
        text-align: left;
    }

    /* Styles du bouton hamburger anim√© */
    .hamburger-btn {
        display: none;
        background: none;
        border: none;
        cursor: pointer;
        display: flex;
        flex-direction: column;
        justify-content: space-around;
        width: 30px;
        height: 25px;
        padding: 0;
    }
    
    .hamburger-btn .bar {
        width: 100%;
        height: 3px;
        background-color: var(--secondary-color);
        transition: transform 0.3s ease, opacity 0.3s ease;
    }
    
    .hamburger-btn.open .bar:nth-child(2) {
        opacity: 0;
    }
    
    .hamburger-btn.open .bar:nth-child(1) {
        transform: translateY(11px) rotate(45deg);
    }
    
    .hamburger-btn.open .bar:nth-child(3) {
        transform: translateY(-11px) rotate(-45deg);
    }

    /* Main layout */
    .main-container {
      display: flex;
      flex: 1;
    }

    /* Styles de la Sidebar (Menu) */
    .sidebar {
      width: 280px;
      background: rgba(255, 255, 255, 0.75);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      border-right: 1px solid rgba(255, 255, 255, 0.2);
      box-shadow: var(--shadow);
      height: calc(100vh - 80px);
      position: sticky;
      top: 80px;
      padding: 25px 0;
      overflow-y: auto;
      transition: transform 0.4s ease-in-out; 
    }
    
    .sidebar.open {
        transform: translateX(0);
    }

    .welcome-section {
      padding: 0 25px 25px;
      border-bottom: 1px solid rgba(0, 0, 0, 0.1);
      margin-bottom: 20px;
    }

    .welcome-text {
      color: var(--text-light);
      font-size: 0.9rem;
      margin-bottom: 5px;
    }

    .username {
      font-weight: 600;
      font-size: 1.2rem;
      color: var(--primary-color);
    }

    .menu-category {
      padding: 15px 25px 5px;
      font-size: 0.85rem;
      color: var(--text-light);
      text-transform: uppercase;
      letter-spacing: 1px;
      font-weight: 600;
    }

    .menu-item {
      padding: 12px 25px 12px 35px;
      display: flex;
      align-items: center;
      gap: 15px;
      color: var(--text-color);
      text-decoration: none;
      font-weight: 500;
      border-left: 4px solid transparent;
      position: relative;
      overflow: hidden;
      animation: fadeIn 0.5s ease-out;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateX(-20px); }
      to { opacity: 1; transform: translateX(0); }
    }
    
    .menu-item::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(0, 0, 0, 0.05), transparent);
      transition: all 0.5s ease;
    }
    .menu-item:hover::before {
      left: 100%;
    }

    .menu-item:hover, .menu-item.active {
      background-color: rgba(0, 0, 0, 0.05);
      border-left-color: var(--primary-color);
      color: var(--primary-color);
    }

    .menu-item i {
      width: 20px;
      text-align: center;
      font-size: 1.1rem;
      transition: transform 0.3s ease;
    }

    .menu-item:hover i {
      transform: scale(1.1) rotate(5deg);
    }

    .menu-badge {
      position: absolute;
      right: 25px;
      font-size: 0.75rem;
      font-weight: 700;
      padding: 2px 8px;
      border-radius: 10px;
      text-shadow: 0 1px 1px rgba(0, 0, 0, 0.2);
      animation: popIn 0.5s ease-out;
    }
    
    @keyframes popIn {
      from { transform: scale(0); opacity: 0; }
      to { transform: scale(1); opacity: 1; }
    }
    
    .menu-badge.active {
      background-color: var(--badge-active);
      color: white;
    }
    
    .menu-badge.inactive {
      background-color: var(--badge-inactive);
      color: white;
    }

    /* Contenu principal */
    .content {
      flex: 1;
      padding: 30px;
    }

    .page-title {
      font-size: 1.5rem;
      margin-bottom: 25px;
      color: var(--secondary-color);
      font-weight: 700;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .page-title i {
      color: var(--primary-color);
    }

    /* Banni√®re Challenge */
    .challenge-banner {
      background: linear-gradient(135deg, var(--purple-color) 0%, #6a3093 100%);
      border-radius: 12px;
      padding: 25px;
      box-shadow: var(--shadow);
      margin-bottom: 30px;
      color: white;
      position: relative;
      overflow: hidden;
    }

    .challenge-banner::before {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: linear-gradient(to right, transparent, rgba(255, 255, 255, 0.2), transparent);
      transform: rotate(45deg);
      animation: shimmer 3s infinite;
    }

    @keyframes shimmer {
      0% { transform: translateX(-100%) rotate(45deg); }
      100% { transform: translateX(100%) rotate(45deg); }
    }

    .banner-title {
      font-size: 1.5rem;
      margin-bottom: 15px;
      font-weight: 600;
      position: relative;
      z-index: 1;
    }

    .banner-text {
      font-size: 1rem;
      margin-bottom: 20px;
      opacity: 0.9;
      position: relative;
      z-index: 1;
      line-height: 1.6;
    }

    /* Sections Challenge */
    .challenge-section {
      background-color: var(--card-bg);
      border-radius: 12px;
      padding: 25px;
      box-shadow: var(--shadow);
      margin-bottom: 30px;
    }

    .section-title {
      font-size: 1.3rem;
      margin-bottom: 20px;
      color: var(--secondary-color);
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .section-title i {
      color: var(--purple-color);
    }

    .section-subtitle {
      font-size: 1rem;
      margin-bottom: 20px;
      color: var(--text-light);
    }

    /* Tableau des meilleurs parrains */
    .leaderboard-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }

    .leaderboard-table th, .leaderboard-table td {
      padding: 15px;
      text-align: left;
      border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    }

    .leaderboard-table th {
      background-color: rgba(0, 0, 0, 0.05);
      font-weight: 600;
      color: var(--text-color);
    }

    .leaderboard-table tr {
      transition: background-color 0.2s ease;
    }

    .leaderboard-table tr:hover {
      background-color: rgba(0, 0, 0, 0.03);
    }

    .rank-cell {
      font-weight: 700;
      text-align: center;
      width: 60px;
    }

    .rank-1 {
      color: var(--gold-color);
      font-size: 1.2rem;
    }

    .rank-2 {
      color: var(--silver-color);
      font-size: 1.1rem;
    }

    .rank-3 {
      color: var(--bronze-color);
    }

    .reward-cell {
      font-weight: 600;
      color: var(--success-color);
    }

    .user-rank {
      margin-top: 25px;
      padding: 20px;
      background: linear-gradient(135deg, var(--primary-light) 0%, var(--primary-dark) 100%);
      border-radius: 12px;
      color: white;
      text-align: center;
    }

    .user-rank h3 {
      margin-bottom: 10px;
      font-size: 1.2rem;
    }

    .user-rank-value {
      font-size: 2rem;
      font-weight: 700;
      margin-bottom: 10px;
    }

    .user-referrals {
      font-size: 1.1rem;
      margin-bottom: 15px;
    }

    /* Footer */
    .footer {
      background-color: var(--card-bg);
      padding: 20px 30px;
      text-align: center;
      box-shadow: 0 -4px 12px rgba(0, 0, 0, 0.08);
      margin-top: auto;
    }

    .footer-content {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .footer-links {
      display: flex;
      justify-content: center;
      gap: 20px;
      flex-wrap: wrap;
    }

    .footer-link {
      color: var(--primary-color);
      text-decoration: none;
      font-weight: 500;
      transition: color 0.2s ease;
    }

    .footer-link:hover {
      text-decoration: underline;
      color: var(--primary-dark);
    }

    .footer-text {
      color: var(--text-light);
      font-size: 0.9rem;
    }

    /* Overlay et modal */
    .overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: rgba(0, 0, 0, 0.5);
      z-index: 98;
    }
    
    .overlay.active {
      display: block;
    }

    /* Animation for notifications */
    .notification-container {
      position: fixed;
      top: 20px;
      right: 20px;
      z-index: 9999;
      display: flex;
      flex-direction: column;
      gap: 10px;
      pointer-events: none;
    }

    .notification {
      padding: 15px 20px;
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      display: flex;
      align-items: center;
      gap: 10px;
      max-width: 350px;
      animation: slideIn 0.3s ease forwards;
      position: relative;
      overflow: hidden;
      color: white;
      pointer-events: auto;
    }

    .notification.success {
      background: linear-gradient(135deg, var(--success-color) 0%, #2AB32A 100%);
    }

    .notification.error {
      background: linear-gradient(135deg, var(--danger-color) 0%, #c0392b 100%);
    }

    .notification.info { 
      background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-dark) 100%); 
    }

    @keyframes slideIn {
      from {
        transform: translateX(110%);
        opacity: 0;
      }
      to {
        transform: translateX(0);
        opacity: 1;
      }
    }

    /* Responsive adjustments */
    @media (max-width: 992px) {
      .sidebar {
        width: 230px;
      }
    }

    @media (max-width: 768px) {
        .main-container {
            flex-direction: column;
        }
        
        .hamburger-btn {
            display: flex;
            position: absolute;
            top: 20px;
            left: 20px;
            z-index: 101;
        }

        .sidebar {
            width: 75%;
            max-width: 300px;
            height: 100vh;
            position: fixed;
            top: 0;
            left: -100%;
            z-index: 99;
            transition: left 0.4s ease-in-out;
        }
        
        .sidebar.open {
            left: 0;
        }
        
        .overlay.active {
            display: block;
        }
        
        .header {
            padding: 15px;
        }
        
        .logo {
            font-size: 1.5rem;
            margin-left: 50px;
        }
        
        .content {
            padding: 20px;
        }
        
        .leaderboard-table {
          font-size: 0.9rem;
        }
        
        .leaderboard-table th, .leaderboard-table td {
          padding: 10px;
        }
    }

    @media (max-width: 576px) {
      .leaderboard-table {
        display: block;
        overflow-x: auto;
      }
      
      .footer-links {
        flex-direction: column;
        gap: 10px;
      }
    }
  </style>
</head>
<body>
  <div class="loader-container" id="loader">
    <div class="loader"></div>
  </div>

  <div class="notification-container" id="notificationContainer"></div>

  <header class="header">
    <button class="hamburger-btn" id="hamburgerBtn" aria-label="Toggle menu">
        <div class="bar"></div>
        <div class="bar"></div>
        <div class="bar"></div>
    </button>
    
    <div class="logo">
      <span>MULAFLOWR</span>
    </div>
    
    <div class="header-controls">
      <button class="language-selector" id="languageSelector">
        <i class="fas fa-globe"></i>
        <span>French</span>
        <i class="fas fa-chevron-down"></i>
      </button>
      
      <div class="user-profile" id="userProfile">
          <div class="avatar" id="userAvatar">U</div>
          <div class="profile-dropdown" id="profileDropdown">
              <button class="theme-toggle" id="themeToggle">
                  <i class="fas fa-moon"></i>
                  <span>Mode nuit</span>
              </button>
          </div>
      </div>
    </div>
  </header>

  <div class="overlay" id="overlay"></div>

  <div class="main-container">
    <aside class="sidebar" id="sidebar">
      <div class="welcome-section">
        <div class="welcome-text">Challenge and Rewards >> MULAFLOWR</div>
        <div class="username" id="sidebarUsername">Utilisateur</div>
      </div>
      
      <div class="menu-category">PRINCIPAL</div>
      <a href="dashboard.html" class="menu-item">
        <i class="fas fa-home"></i>
        <span>Tableau de bord</span>
      </a>
      
      <a href="depot.html" class="menu-item">
        <i class="fas fa-wallet"></i>
        <span>D√©p√¥t üíµ</span>
      </a>
      
      <a href="bonus_bienvenue.html" class="menu-item">
        <i class="fas fa-gift"></i>
        <span>Bonus de bienvenue</span>
      </a>
      
      <div class="menu-category">COMPTES</div>
      <a href="retrait.html" class="menu-item">
        <i class="fas fa-money-bill-wave"></i>
        <span>Retrait</span>
      </a>
      
      <a href="equipe.html" class="menu-item">
        <i class="fas fa-users"></i>
        <span>√âquipe</span>
      </a>

      <div class="menu-category">SP√âCIAL</div>
      <a href="love_earn.html" class="menu-item">
        <i class="fas fa-heart"></i>
        <span>LoveEarn</span>
      </a>
      
      <a href="social_boost.html" class="menu-item">
        <i class="fas fa-rocket"></i>
        <span>SBH</span>
      </a>
      
      <a href="challenge_reward.html" class="menu-item active">
        <i class="fas fa-medal"></i>
        <span>Challenge and Reward</span>
        <span class="menu-badge active">‚òë</span>
      </a>
      
      <div class="menu-category">PRODUIT / TACHE</div>
      <a href="whatsapp_earn.html" class="menu-item">
        <i class="fab fa-whatsapp"></i>
        <span>Gagner via Whatsapp</span>
      </a>
      
      <a href="movies.html" class="menu-item">
        <i class="fas fa-film"></i>
        <span>Movies</span>
      </a>
      
      <a href="paris_fixes.html" class="menu-item">
        <i class="fas fa-chart-line"></i>
        <span>Paris fixes</span>
      </a>
      
      <a href="gains_publicitaires.html" class="menu-item">
        <i class="fas fa-ad"></i>
        <span>Gains publicitaires</span>
      </a>
      
      <a href="spin_wheel.html" class="menu-item">
        <i class="fas fa-trophy"></i>
        <span>Spin wheel üèÜ</span>
      </a>
      
      <a href="tiktok_earn.html" class="menu-item">
        <i class="fab fa-tiktok"></i>
        <span>TikTok Earn</span>
      </a>
      
      <a href="youtube_earn.html" class="menu-item">
        <i class="fab fa-youtube"></i>
        <span>YouTube Earn</span>
      </a>
      
      <a href="instagram_earn.html" class="menu-item">
        <i class="fab fa-instagram"></i>
        <span>Instagram Earn</span>
      </a>
      
      <a href="trivia_challenge.html" class="menu-item">
        <i class="fas fa-brain"></i>
        <span>TRIVIA challenge</span>
      </a>
      
      <div class="menu-category">BONUS</div>
      <a href="liste_contacts.html" class="menu-item">
        <i class="fas fa-address-book"></i>
        <span>Liste de contacts gratuit üÜì</span>
      </a>
      
      <a href="booster_visibilite.html" class="menu-item">
        <i class="fas fa-rocket"></i>
        <span>Booster ma visibilit√©</span>
      </a>

      <a href="canva_pro.html" class="menu-item">
        <i class="fas fa-palette"></i>
        <span>Canva Pro</span>
      </a>
      
      <a href="connexion_gratuite.html" class="menu-item">
        <i class="fas fa-shield-alt"></i>
        <span>Connexion gratuite</span>
      </a>
    </aside>

    <main class="content">
      <h1 class="page-title">
        <i class="fas fa-medal"></i>
        <span>Challenge and Rewards</span>
      </h1>
      
      <div class="challenge-banner">
        <h2 class="banner-title">D√©fiez-vous et gagnez des r√©compenses!</h2>
        <div class="banner-text">
          Le classement des meilleurs parrains de MULAFLOWR! Ici, nous r√©compensons les membres les plus actifs qui ont parrain√© le plus de personnes. Plus vous parrainez, plus vous grimpez dans le classement et plus vos r√©compenses sont importantes. Les r√©compenses sont mises √† jour chaque semaine, alors continuez √† inviter vos amis!
        </div>
      </div>
      
      <div class="challenge-section">
        <h2 class="section-title"><i class="fas fa-trophy"></i> Classement des Meilleurs Parrains</h2>
        <p class="section-subtitle">Voici le top 20 des parrains les plus actifs cette semaine. Les 5 premiers re√ßoivent des r√©compenses sp√©ciales!</p>
        
        <table class="leaderboard-table">
          <thead>
            <tr>
              <th class="rank-cell">Rang</th>
              <th>Nom d'utilisateur</th>
              <th>Personnes parrain√©es</th>
              <th>R√©compense</th>
            </tr>
          </thead>
          <tbody id="leaderboardBody">
            <!-- Les donn√©es seront charg√©es dynamiquement -->
          </tbody>
        </table>
        
        <div class="user-rank" id="userRankSection">
          <h3>Votre classement</h3>
          <div class="user-rank-value" id="userRank">--</div>
          <div class="user-referrals" id="userReferrals">Personnes parrain√©es: 0</div>
          <p>Continuez √† parrainer pour grimper dans le classement et gagner des r√©compenses!</p>
        </div>
      </div>
      
      <div class="challenge-section">
        <h2 class="section-title"><i class="fas fa-gift"></i> Syst√®me de R√©compenses</h2>
        <p class="section-subtitle">Comment fonctionnent les r√©compenses et comment en b√©n√©ficier?</p>
        
        <div style="margin-top: 20px;">
          <h4>R√©compenses hebdomadaires:</h4>
          <ul style="margin-left: 20px; margin-bottom: 20px;">
            <li><strong>1√®re place:</strong> Multipliez votre solde par 4 + 20 000 FCFA</li>
            <li><strong>2√®me place:</strong> Multipliez votre solde par 3 + 15 000 FCFA</li>
            <li><strong>3√®me place:</strong> Multipliez votre solde par 2 + 10 000 FCFA</li>
            <li><strong>4√®me place:</strong> 5 000 FCFA</li>
            <li><strong>5√®me place:</strong> 1 000 FCFA</li>
          </ul>
          
          <h4>Comment participer:</h4>
          <p>Pour participer au challenge, il suffit de parrainer un maximum de personnes en partageant votre lien de parrainage. Chaque personne qui s'inscrit via votre lien augmente votre score dans le classement.</p>
          
          <h4>Quand sont distribu√©es les r√©compenses:</h4>
          <p>Les r√©compenses sont distribu√©es chaque dimanche √† minuit. Le classement est remis √† z√©ro chaque semaine pour donner √† tous une chance de gagner.</p>
        </div>
      </div>
    </main>
  </div>

  <footer class="footer">
    <div class="footer-content">
      <div class="footer-links">
        <a href="https://social-boost-horizon-new-sbh.vercel.app" class="footer-link">Pro Tech Management</a>
        <a href="https://social-boost-horizon-new-sbh.vercel.app" class="footer-link">Site propuls√© par Social Boost Horizon</a>
      </div>
      <div class="footer-text">
        ¬© 2025 MULAFLOWR. Tous droits r√©serv√©s.
      </div>
    </div>
  </footer>

  <script>
    /******** CONFIG FIREBASE ********/
    const firebaseConfig = {
      apiKey: "AIzaSyCjGisjgbFc2ZE0BFgdhlUao8bCCeuKP1k",
      authDomain: "cash-flowr.firebaseapp.com",
      projectId: "cash-flowr",
      storageBucket: "cash-flowr.appspot.com",
      messagingSenderId: "1091928501310",
      appId: "1:1091928501310:web:4f4de306cde36f378ff56f",
      measurementId: "G-5SF6VDLZCB"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();
    const auth = firebase.auth();

    /******** DOM Elements ********/
    const hamburgerBtn = document.getElementById('hamburgerBtn');
    const sidebar = document.getElementById('sidebar');
    const overlay = document.getElementById('overlay');
    const themeToggle = document.getElementById('themeToggle');
    const userProfile = document.getElementById('userProfile');
    const profileDropdown = document.getElementById('profileDropdown');
    const languageSelector = document.getElementById('languageSelector');
    const sidebarUsername = document.getElementById('sidebarUsername');
    const userAvatar = document.getElementById('userAvatar');
    const loader = document.getElementById('loader');
    const leaderboardBody = document.getElementById('leaderboardBody');
    const userRankSection = document.getElementById('userRankSection');
    const userRank = document.getElementById('userRank');
    const userReferrals = document.getElementById('userReferrals');

    /******** Variables d'√©tat ********/
    let currentUser = null;
    let userData = {};

    /******** UI helpers ********/
    function showNotification(type, title, message, duration = 4000) {
      const container = document.getElementById('notificationContainer');
      const notification = document.createElement('div');
      notification.className = `notification ${type}`;
      const icon = type === 'success' ? 'fa-check-circle' : (type === 'error' ? 'fa-exclamation-circle' : 'fa-info-circle');
      notification.innerHTML = `
        <i class="fas ${icon}" style="font-size: 1.5rem;"></i>
        <div>
          <strong style="display: block; margin-bottom: 5px;">${title}</strong>
          <span>${message}</span>
        </div>
      `;
      container.appendChild(notification);
      setTimeout(() => {
        notification.style.animation = 'slideIn 0.3s ease reverse forwards';
        setTimeout(() => { if (container.contains(notification)) container.removeChild(notification); }, 300);
      }, duration);
    }

    /******** Gestion du menu ********/
    hamburgerBtn.addEventListener('click', () => {
        sidebar.classList.toggle('open');
        overlay.classList.toggle('active');
        hamburgerBtn.classList.toggle('open');
    });
    overlay.addEventListener('click', () => {
        sidebar.classList.remove('open');
        overlay.classList.remove('active');
        hamburgerBtn.classList.remove('open');
    });

    /******** Gestion du profil utilisateur ********/
    userProfile.addEventListener('click', (event) => {
        event.stopPropagation();
        profileDropdown.classList.toggle('active');
    });
    document.addEventListener('click', (event) => {
        if (!userProfile.contains(event.target)) {
            profileDropdown.classList.remove('active');
        }
    });

    /******** Gestion du th√®me ********/
    themeToggle.addEventListener('click', (event) => {
        event.stopPropagation();
        document.body.classList.toggle('dark-mode');
        const isDarkMode = document.body.classList.contains('dark-mode');
        themeToggle.innerHTML = isDarkMode 
            ? '<i class="fas fa-sun"></i><span>Mode jour</span>' 
            : '<i class="fas fa-moon"></i><span>Mode nuit</span>';
        if(currentUser) saveUserData('theme', isDarkMode ? 'dark' : 'light');
    });

    /******** Fonctions Firestore ********/
    async function saveUserData(key = null, value = null) {
      if (!currentUser) return;
      try {
        const userRef = db.collection('users').doc(currentUser.uid);
        const dataToSave = key ? { [key]: value } : userData;
        await userRef.set({ ...dataToSave, lastUpdate: new Date() }, { merge: true });
        console.log('Donn√©es utilisateur enregistr√©es avec succ√®s.');
      } catch (error) {
        console.error("Erreur lors de la sauvegarde des donn√©es :", error);
        showNotification('error', 'Erreur de sauvegarde', 'Impossible de sauvegarder vos donn√©es.');
      }
    }

    async function loadUserData() {
      if (!currentUser) throw new Error("Aucun utilisateur connect√© pour charger les donn√©es.");
      const userRef = db.collection('users').doc(currentUser.uid);
      const doc = await userRef.get();
      if (doc.exists) {
          const data = doc.data() || {};
          userData = {
              displayName: data.displayName || currentUser.displayName,
              email: data.email || currentUser.email,
              phoneNumber: data.phoneNumber || data.phone || "",
              country: data.country || data.pays || "",
              theme: data.theme || 'light',
              activeReferrals: data.activeReferrals || data.parrainageCount || 0
          };
      } else {
        userData = { theme: 'light', activeReferrals: 0 };
        await saveUserData();
      }
    }

    async function getTopReferrers() {
      try {
        const usersRef = db.collection('users');
        const querySnapshot = await usersRef
          .where('activeReferrals', '>=', 15)
          .orderBy('activeReferrals', 'desc')
          .limit(20)
          .get();
        
        const topReferrers = [];
        querySnapshot.forEach((doc) => {
          const data = doc.data();
          topReferrers.push({
            id: doc.id,
            displayName: data.displayName || 'Utilisateur',
            activeReferrals: data.activeReferrals || 0
          });
        });
        
        return topReferrers;
      } catch (error) {
        console.error("Erreur lors de la r√©cup√©ration des meilleurs parrains :", error);
        showNotification('error', 'Erreur', 'Impossible de charger le classement.');
        return [];
      }
    }

    function displayLeaderboard(referrers) {
      if (referrers.length === 0) {
        leaderboardBody.innerHTML = `
          <tr>
            <td colspan="4" style="text-align: center; padding: 30px;">
              Aucun parrain n'a encore atteint le classement. Soyez le premier!
            </td>
          </tr>
        `;
        return;
      }
      
      let html = '';
      referrers.forEach((referrer, index) => {
        const rank = index + 1;
        let reward = '';
        
        // D√©terminer la r√©compense en fonction du rang
        if (rank === 1) reward = 'x4 solde + 20 000 FCFA';
        else if (rank === 2) reward = 'x3 solde + 15 000 FCFA';
        else if (rank === 3) reward = 'x2 solde + 10 000 FCFA';
        else if (rank === 4) reward = '5 000 FCFA';
        else if (rank === 5) reward = '1 000 FCFA';
        else reward = '---';
        
        html += `
          <tr>
            <td class="rank-cell ${rank <= 3 ? 'rank-' + rank : ''}">${rank}</td>
            <td>${referrer.displayName}</td>
            <td>${referrer.activeReferrals}</td>
            <td class="reward-cell">${reward}</td>
          </tr>
        `;
      });
      
      leaderboardBody.innerHTML = html;
    }

    function updateUserRank(referrers) {
      if (!currentUser) return;
      
      // Trouver le rang de l'utilisateur actuel
      const userIndex = referrers.findIndex(ref => ref.id === currentUser.uid);
      
      if (userIndex !== -1) {
        userRank.textContent = `#${userIndex + 1}`;
      } else {
        userRank.textContent = 'Hors top 20';
      }
      
      userReferrals.textContent = `Personnes parrain√©es: ${userData.activeReferrals || 0}`;
    }

    /******** Initialisation de l'application ********/
    function updateUserInfoUI(user, dbData = {}) {
        const displayName = dbData.displayName || user.displayName || user.email.split('@')[0];
        if (sidebarUsername) sidebarUsername.textContent = displayName;
        if (userAvatar) userAvatar.textContent = displayName.charAt(0).toUpperCase();
    }

    function applyTheme() {
        const isDarkMode = userData.theme === 'dark';
        document.body.classList.toggle('dark-mode', isDarkMode);
        themeToggle.innerHTML = isDarkMode 
            ? '<i class="fas fa-sun"></i><span>Mode jour</span>' 
            : '<i class="fas fa-moon"></i><span>Mode nuit</span>';
    }

    auth.onAuthStateChanged(async (user) => {
        if (user) {
            currentUser = user;
            try {
                await loadUserData();
                updateUserInfoUI(user, userData);
                applyTheme();
                
                // Charger le classement
                const topReferrers = await getTopReferrers();
                displayLeaderboard(topReferrers);
                updateUserRank(topReferrers);
                
                document.body.classList.add('loaded');
                loader.classList.add('hidden');
                
            } catch (error) {
                console.error("Erreur critique lors de l'initialisation :", error);
                showNotification('error', 'Erreur Critique', "Impossible de charger vos donn√©es. Veuillez vous reconnecter.");
                auth.signOut();
                setTimeout(() => { window.location.href = 'login.html'; }, 3000);
            }
        } else {
            window.location.href = 'login.html';
        }
    });

    /******** Initialisation au chargement de la page ********/
    document.addEventListener('DOMContentLoaded', () => {
      // Rien de sp√©cifique pour le moment
    });
  </script>
</body>
</html>